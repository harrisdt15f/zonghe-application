{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\Hall\\Head/assets\\Script\\Hall\\Head\\HeadBoxNode.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Hall\\Head","sourcesContent":["\n\nimport { G_OnFire } from '../../Net/OnFire';\n import {uiEventFunction } from '../../Config/uiEvent';\nimport { headNum } from '../../Config/config';\n\nimport { G_UserControl } from '../../Controller/UserControl';\nimport { G_UiForms } from '../../Tool/UiForms';\nimport { G_Language } from '../../Language/Language';\n\nconst {ccclass, property} = cc._decorator;\n@ccclass\nexport default class HeadBoxNode extends cc.Component {\n\n    @property(cc.SpriteAtlas)\n    headAtlas : cc.SpriteAtlas = null;\n    @property(cc.Prefab)\n    headImage : cc.Prefab = null;\n    @property(cc.Prefab)\n    headSelect : cc.Prefab = null;\n    \n    //属性\n    private selectBox　: cc.Node = null;\n    // headList : Array<cc.Node> = new Array<cc.Node>();\n    private tmpSelectBox : cc.Node = null;\n    private selectIdx : number = 0;\n\n    onLoad () {\n        // G_HttpHelper.httpGet(RequestEnum.Avatar, function(ret){\n        //     console.log(\"app-api/user/system-avatar数据\",ret); \n\n        //     G_OnFire.fire(EventRequest.HeadUpdata)\n        // }.bind(this))\n    }\n\n    start () {\n        let scrollview = this.node.getChildByName(\"scrollview\");\n        let view = scrollview.getChildByName(\"view\");\n        let content = view.getChildByName(\"content\");\n        content.removeAllChildren()\n\n        this.selectBox = cc.instantiate(this.headSelect)\n        let cur = parseInt(G_UserControl.getUser().usePic);\n        if(!isNaN(cur) && cur > 0)\n        {\n           // cur = cur;\n        }else\n        {\n            cur = 1;\n        }\n        for (let index = 1; index <= headNum; index++) {\n            let piece = cc.instantiate(this.headImage)\n            piece.getComponent(cc.Sprite).spriteFrame = this.headAtlas.getSpriteFrame(\"touxiang\"+index)\n            piece.parent =  content;\n            piece.name = \"heand_\"+index;\n            if (index == cur){\n                this.selectIdx = index;\n                this.tmpSelectBox = piece;\n                this.selectBox.setPosition(cc.v2(0,0))\n                piece.getComponent(cc.Sprite).node.addChild(this.selectBox)\n            }\n            piece.on(cc.Node.EventType.TOUCH_END, this.onSelectHead.bind(this));\n        }\n        let btnTiJiao = this.node.getChildByName(\"btnTiJiao\");\n        btnTiJiao.on(cc.Node.EventType.TOUCH_END, this.onTiJiao.bind(this));\n    }\n\n    // update (dt) {}\n\n    onSelectHead(event){\n        if (this.tmpSelectBox  == event.target){return;}\n        if (this.tmpSelectBox != null && this.tmpSelectBox != event.target){\n            this.tmpSelectBox.removeAllChildren()\n        }\n        event.target.getComponent(cc.Sprite).node.addChild(this.selectBox)\n        this.tmpSelectBox = event.target;\n        let strTxt = event.target.getName()\n        let idx = strTxt.indexOf(\"_\")\n        let str = strTxt.substring(idx+1, strTxt.length)\n        this.selectIdx = Number(str);\n    }\n\n    onTiJiao(){\n         //G_OnFire.fire(UI_EVENT_STATE.UI_HEAD_replace, this.selectIdx);\n        // G_OnFire.fire(UI_EVENT_STATE.UI_HEAD_colse);\n        console.log(\"selectIdx  \",this.selectIdx);\n        \n        G_UserControl.requesPlayerChange(G_UserControl.getUser().userName,this.selectIdx,function(ret){\n            if(ret.status)\n            {\n                G_UiForms.hint(G_Language.get(\"picChangeSuccess\"));\n                G_OnFire.fire(uiEventFunction.colseBox);\n            }else\n            {\n                G_UiForms.hint(ret.message);\n            }\n\n        }.bind(this));\n    }\n\n    onDestroy(){\n        // G_OnFire.off(UI_EVENT_STATE.UI_HEAD_replace)\n        // G_OnFire.off(UI_EVENT_STATE.UI_HEAD_colse)\n    }\n\n}\n"]}