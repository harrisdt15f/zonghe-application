{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\Hall\\Withdraw/assets\\Script\\Hall\\Withdraw\\AtOncePanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Hall\\Withdraw","sourcesContent":["\nimport { G_OnFire } from '../../Net/OnFire';\nimport {G_UiForms} from \"../../Tool/UiForms\"\nimport {uiEventModules, uiEventFunction} from \"../../Config/uiEvent\"\nimport { TEXT_INFO } from '../../Config/IdentifyKey';\nimport { G_WithDrawControl } from '../../Controller/WithDrawControl';\nimport { G_Language } from '../../Language/Language';\nimport { G_UserControl } from '../../Controller/UserControl';\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class AtOncePanel extends cc.Component {\n\n\n    @property({\n        type : cc.Label,\n        tooltip :\"账户余额\"\n    })\n    balance : cc.Label=null;\n \n\n\n    //绑定\n    @property({\n        type : cc.Node,\n        tooltip :\"绑定账户\"\n    })\n    btnBangDing:cc.Node = null;\n    //清除\n    @property({\n        type : cc.Node,\n        tooltip :\"清除已输入的信息\"\n    })\n    btnClear:cc.Node = null;\n\n    @property({\n        type : cc.Node,\n        tooltip :\"设置安全码\"\n    })\n    btnSet:cc.Node = null;\n\n\n\n    @property(cc.Node)\n    labAccount:cc.Node = null;\n    @property(cc.Node)\n    myPulldownMenu:cc.Node = null;\n    \n    @property(cc.Node)\n    myEditboxGolde:cc.Node = null;\n\n\n    @property(cc.Node)\n    labAnQuanMa:cc.Node = null;\n    @property(cc.Node)\n    myEditboxCode = null;\n\n    @property(cc.Node)\n    btnTiXian:cc.Node = null;\n\n    private accountEditBox = null;\n\n    private accountList = [];  //绑定账户列表\n    private _myPulldownMenu : any = null; \n    \n    private accoutNameList = []  //绑定账户列表名称\n    private chooseId = 0;  //当前选定绑定账户index\n\n    private isSecurityCode = false;\n\n\n    onLoad () {\n        this.btnBangDing.on(cc.Node.EventType.TOUCH_END, this.onBangDing.bind(this));\n        this.btnClear.on(cc.Node.EventType.TOUCH_END, this.onClear.bind(this));\n        this.btnSet.on(cc.Node.EventType.TOUCH_END, this.onSet.bind(this));\n        var classEdithbox = this.myEditboxGolde.getComponent(\"MyEditbox\")\n        classEdithbox.onDidEndedCallback = function(target) {\n            var strName =  classEdithbox.getEdiboxComponent().string \n            console.log(\"录完》》\",typeof(strName))\n            var num = Number(strName)\n            if(!isNaN(num) && num > 0){\n                classEdithbox.getEdiboxComponent().string = num.toFixed(2);\n            }\n            //if('number' ==typeof(parseInt(strName)))\n        }\n        classEdithbox.onTextChangedCallback = function(target) {\n            console.log(\"录入》》\")\n        }\n\n    }\n\n    onEnable()\n    {\n        console.log(\"G_UserControl.getUser().balance  \",typeof(G_UserControl.getUser().balance));\n        if(G_UserControl.getUser().balance)\n        {\n            this.balance.string = G_UserControl.getUser().balance.toFixed(2); \n        }\n        G_WithDrawControl.GetMyAccountList(()=>{\n            this.accountList = G_WithDrawControl.getConfig().MyAccountList;\n            this.showInfo();\n        });\n    }\n    showInfo(){\n        if(this.accountList.length <= 0)\n        {\n            this.labAccount.active = true;\n            this.btnBangDing.active = true;\n            this.myPulldownMenu.active = false;\n            this.isSecurityCode = false;\n            this.labAnQuanMa.active = true;\n            this.myEditboxCode.active = false;\n            this.btnSet.active = true;\n        }else\n        {\n            this.labAccount.active = false;\n            this.myPulldownMenu.active = true;\n            this.btnBangDing.active = false;\n            this.isSecurityCode = true;\n            this.labAnQuanMa.active = false;\n            this.myEditboxCode.active = true;\n            this.btnSet.active =false;\n            for(let i=0;i<this.accountList.length;i++)\n            {\n                console.log(\"this.accountList[i].code \"+this.accountList[i].code);\n                \n                let bankInfo =  G_WithDrawControl.getConfig().getPayItemInfo(this.accountList[i].code);\n                this.accoutNameList[i] = bankInfo.name+\" \"+this.accountList[i].card_number_hidden\n            }\n            if(this.myPulldownMenu){\n                this._myPulldownMenu = this.myPulldownMenu.getComponent(\"MyPulldownMenu\")\n                this._myPulldownMenu.menuData = this.accoutNameList;\n                //this.chooseId = this._myPulldownMenu.selectResult.selectedId;\n                var selectedText = this._myPulldownMenu.selectResult.text;\n                console.log(\"选择了什么》》\",this.chooseId,selectedText)\n            }\n        }\n\n    }\n\n\n\n    onWithDrwClick(){\n        if(this.accountList == null || this.accountList.length == 0)\n        {\n            G_UiForms.hint(G_Language.get(\"bindEmpty\"))\n            return\n        }\n        var val = this.myEditboxGolde.getComponent(\"MyEditbox\").getEdiboxComponent().string \n        var money = Number(val);\n        console.log(typeof(money),\"   \",money);\n        //if(money)\n        var code = '';\n        if(this.isSecurityCode)\n        {\n            code = this.myEditboxCode.getComponent(\"MyEditbox\").getEdiboxComponent().string \n            if(code == null || code == '')\n            {\n                G_UiForms.hint(G_Language.get(\"securityisEmpty\"))\n                return;\n            }\n        }else\n        {\n            G_UiForms.hint(G_Language.get(\"securityisEmpty\"))\n            return;\n        }\n        if(isNaN(money)){\n            G_UiForms.hint(G_Language.get(\"balanceError\"))\n            return;\n        }\n        if(money > G_UserControl.getUser().balance){\n            G_UiForms.hint(G_Language.get(\"balanceLess\"))\n            return;           \n        }\n        var choose = this._myPulldownMenu.selectResult.selectedId;\n        console.log(\"choose  \",choose);\n        \n        G_WithDrawControl.requesWithDraw(money,this.accountList[choose].id,code,function(ret){\n            if(ret.status){\n                G_UiForms.hint(G_Language.get(\"withDrawing\"))\n                this.balance.string = G_UserControl.getUser().balance.toFixed(2);\n            }else\n            {\n                G_UiForms.hint(ret.message)\n            }\n        }.bind(this)\n        \n    }\n    onDestroy(){\n        G_OnFire.off(uiEventFunction.atOnceManage);\n    }\n\n    onBangDing(){\n        G_UiForms.setSelectPanelShow(TEXT_INFO.TX_bangding_quxiao_queding);\n        G_OnFire.fire(uiEventFunction.atOnceManage, false);\n        G_UiForms.hint(\"绑定了什么\")\n    }\n\n    onClear(){\n        this.myEditboxGolde.getComponent(\"MyEditbox\").getEdiboxComponent().string = \"\";\n    }\n\n    onSet(){\n        G_UiForms.show(uiEventModules.setNode)\n        G_UiForms.setSelectPanelShow(TEXT_INFO.xiuGaiAnMa);\n        G_OnFire.fire(uiEventFunction.atOnceManage, false);\n    }\n    // update (dt) {}\n\n}\n"]}