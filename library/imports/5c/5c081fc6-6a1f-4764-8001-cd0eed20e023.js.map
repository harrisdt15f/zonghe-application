{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\Hall\\Activity/assets\\Script\\Hall\\Activity\\RouletteBox.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Hall\\Activity","sourcesContent":["\n\nconst {ccclass, property} = cc._decorator;\nimport { RewardType } from \"../../Config/config\";\nimport { G_Utils } from '../../Tool/Utils';\n\nconst rewardList ={\n    [0]:{\n        [RewardType.iphone]:0\n    },\n    [1]:{\n        [RewardType.gold]:1\n    },\n    [2]:{\n        [RewardType.none]:0\n    },\n    [3]:{\n        [RewardType.gold]:99\n    },\n    [4]:{\n        [RewardType.macbook]:0\n    },\n    [5]:{\n        [RewardType.gold]:8\n    },\n    [6]:{\n        [RewardType.gold]:8888\n    },\n    [7]:{\n        [RewardType.iwatch]:0\n    },\n    [8]:{\n        [RewardType.gold]:588\n    },\n    [9]:{\n        [RewardType.car]:0\n    },\n\n}\n\nenum animationType{\n    rotate =0,\n    trailing = 1,\n}\n\n@ccclass\nexport default class RouletteBox extends cc.Component {\n\n    @property({\n        type : cc.Enum(animationType),\n        tooltip:\"动作类型： rotate:旋转动画 trailing:拖尾动画\"\n    })\n    actionType = animationType.rotate;\n\n\n    @property(cc.Node)\n    btnStart : cc.Node = null;\n\n    @property(cc.Node)\n    btnClose : cc.Node = null;\n\n    @property(cc.Node)\n    gainNode : cc.Node = null;\n\n    \n    @property(cc.Node)\n    dial : cc.Node = null;\n\n    @property(cc.Node)\n    pointer : cc.Node = null;\n\n    @property(cc.Node)\n    dialTrailing : cc.Node = null;\n \n    private inMotion : boolean = false;\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        G_Utils.onClickEnd(this.btnClose, this.onClose, this)\n        G_Utils.onClickEnd(this.btnStart, this.onStart, this)\n    }\n\n    start () {\n\n    }\n\n    // update (dt) {}\n\n    onEnable(){\n        this.pointer.active = this.actionType == animationType.rotate;\n        this.dialTrailing.active = this.actionType == animationType.trailing;\n        if(this.actionType == animationType.trailing)\n            this.trailingInit()\n    }\n\n    onStart(){\n        if(this.inMotion){\n            return;\n        }\n        this.inMotion = true;\n        this.btnStart.getComponent(cc.Button).interactable = false\n\n        var target : number = G_Utils.random(0,9)\n        switch (this.actionType) {\n            case animationType.rotate:\n                this.rotateAnimation(target)\n                break;\n            case animationType.trailing:\n                this.trailingAnimation(target)\n                break;\n            default:\n                break;\n        }\n \n    }\n\n    onDestroy(){\n        this.btnStart.off(cc.Node.EventType.TOUCH_END, this.onStart,this);\n        this.btnClose.off(cc.Node.EventType.TOUCH_END, this.onClose,this);\n    }\n\n    onClose(){\n        this.node.active = false;\n    }\n\n\n    trailingInit(){\n        if(!this.dialTrailing || this.dialTrailing.children.length <= 0)\n            return;\n\n        this.dialTrailing.children.forEach(function(item, idx){\n            item.opacity = 0;\n        },this)\n        this.dialTrailing.children[0].opacity = 255\n    }\n    /**\n     * 拖尾光效动画\n     * \n     */\n    trailingAnimation(targetNum : number){\n        this.trailingInit();\n        var condition = 6\n        var tiemCont = 0\n        while (condition) {\n            var tempIdx = 0\n            var tempNum = condition == 1 ? targetNum : 9\n            for (let index = 0; index <= tempNum; index++) {\n                tempIdx = index % 10\n                var dTime = (tiemCont / 10) ;\n                // console.log(\"间隔时间》》\",dTime)\n                if(condition == 1 && targetNum  == index){\n                    cc.tween(this.dialTrailing.children[tempIdx])\n                    .delay(dTime)\n                    .to(0 ,{opacity : 255})\n                    .then(cc.blink(1, 6))\n                    .call(function(){\n                        var data = rewardList[ targetNum ]\n                        this.prizeShow(data)\n                    }.bind(this))\n                    .start()\n                }else{\n                    cc.tween(this.dialTrailing.children[tempIdx])\n                    .delay(dTime)\n                    .to(0 ,{opacity : 255})\n                    .to(0.4,{opacity : 0})\n                    .start()\n                }\n                tiemCont++\n            }\n            condition--\n        }\n    }\n\n    private tempAngle : number = 0;\n    /**\n     * 旋转动画\n     */\n    rotateAnimation(targetNum : number){\n        var targetRotate : number = 36 * targetNum;\n        var rotateCount : number = 30 * 360\n        var targetAngle : number = targetRotate + rotateCount;\n        if(this.tempAngle)\n            targetAngle = targetAngle - this.tempAngle\n\n        cc.tween(this.dial)\n        .then( cc.rotateBy(6,targetAngle).easing(cc.easeOut(8)) )\n        .call(function(){\n            var data : any = rewardList[ 10 - targetNum ]\n            this.prizeShow(data)\n            this.tempAngle = targetRotate\n        }.bind(this))\n        .start()\n    \n    }\n\n    prizeShow(targetData : any){\n        this.btnStart.getComponent(cc.Button).interactable = true;\n        this.inMotion = false;\n        this.gainNode.active = true;\n        this.gainNode.getComponent(\"GainNode\").openGain(targetData)\n    }\n\n}\n"]}