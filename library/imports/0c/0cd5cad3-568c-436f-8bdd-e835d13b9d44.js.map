{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\Common/assets\\Script\\Common\\MyPulldownMenu.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Common","sourcesContent":["\n/**\n * 自定义 下拉列表\n */\nimport List from './List';\nimport { G_Utils } from '../Tool/Utils';\n\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class MyPullDownSelectNode extends cc.Component {\n    @property(List)\n    list : List = null;\n    @property(cc.Node)\n    selectMenu : cc.Node = null;\n    @property(cc.Label)\n    text : cc.Label = null;\n    @property(cc.Node)\n    arrows : cc.Node = null;\n\n\n    @property(cc.Node)\n    mask : cc.Node = null;\n\n    @property({\n        type: cc.Component.EventHandler,\n        tooltip: CC_DEV && '选择',\n    })\n    private selectedEvent: cc.Component.EventHandler = new cc.Component.EventHandler();\n   \n\n    @property({\n        type: cc.Component.EventHandler,\n        tooltip: CC_DEV && '点击事件',\n    })\n    private clickEvent: cc.Component.EventHandler = new cc.Component.EventHandler();\n    // LIFE-CYCLE CALLBACKS:\n\n    private _tempFlag : boolean = true;\n\n    private _selectResult : any = {};\n    set selectResult(result : any){\n        this._selectResult = result;\n    }\n    get selectResult(){\n        return this._selectResult\n    }\n\n    private _menuData : any = null;\n    set menuData(data: any){\n        this._menuData = data;\n        this.text.getComponent(cc.Label).string = data[0];\n        if(this.list.node.active){\n            this.list.numItems = this._menuData.length\n        }\n        this.selectResult = {\n            \"selectedId\" : 0,\n            \"text\": data[0],\n        }\n    }\n    get menuData(){\n        return this._menuData;\n    }\n\n    private _menuView : boolean = null;\n    set menuView(flag : boolean){\n        this._menuView = flag;\n        this.list.node.active = flag;\n        this.mask.active = flag;\n        if(this._menuData \n            && this.list.numItems <= 0){\n            this._tempFlag = false;\n            this.list.numItems = this._menuData.length\n            this.list.selectedId = 0;\n        }\n        this.arrows.angle = !this.list.node.active ? 0 : 180;\n        //点击在此控件 注册事件监听\n        if(this.clickEvent){\n            cc.Component.EventHandler.emitEvents([this.clickEvent], this.node, flag);\n        }\n    }\n    get menuView(){\n        return this._menuView;\n    }\n\n    onLoad () {\n        // this.selectMenu.on(cc.Node.EventType.TOUCH_END, this.onSelectMenu.bind(this));\n        G_Utils.onClickEnd(this.selectMenu, this.onSelectMenu, this)\n        this._menuView = this.list.node.active\n        if(this.mask){\n            this.mask.x = 0;\n            this.mask.y = 0;\n            this.mask.width = cc.winSize.width\n            this.mask.height = cc.winSize.height\n            var pos : cc.Vec2 = this.mask.convertToWorldSpaceAR(\n                cc.v2(\n                    this.mask.x - this.mask.anchorX * this.mask.width,\n                    this.mask.y - this.mask.anchorY * this.mask.height\n                )\n            )\n            this.mask.x = -pos.x\n            this.mask.y = -pos.y\n            // this.mask.on(cc.Node.EventType.TOUCH_END, this.onMaskClose, this);\n            G_Utils.onClickEnd(this.mask, this.onMaskClose, this)\n            this.mask.active = this._menuView\n        }\n    }\n\n    start () {\n    }\n\n\n    onEnable(){\n \n    }\n\n    // update (dt) {}\n\n    onSelectMenu(){\n        this.menuView = !this.menuView;\n    }\n\n    onListRender(item: cc.Node, idx: number) {\n        item.getChildByName(\"text\").getComponent(cc.Label).string = this._menuData[idx]\n    }\n\n    //当列表项被选择...\n    onListSelected(item: any, selectedId: number, lastSelectedId: number, val: number) {\n        if (!item)\n            return;\n\n        //防止第一次初始的时候关闭了下拉列表框\n        if(!this._tempFlag){\n            this._tempFlag = true;\n            return;\n        }\n\n        this.selectResult = {\n            \"selectedId\" : selectedId,\n            \"text\": this._menuData[selectedId],\n        }\n        this.menuView = !this.menuView;\n        this.text.getComponent(cc.Label).string = this._menuData[selectedId];\n        \n        if (this.selectedEvent) {\n            cc.Component.EventHandler.emitEvents([this.selectedEvent], this.selectResult);\n        }\n    }\n\n    onMaskClose(){\n        this.menuView = !this.menuView;\n    }\n\n}\n"]}