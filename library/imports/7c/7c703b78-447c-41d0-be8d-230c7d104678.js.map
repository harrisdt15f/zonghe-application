{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\Tool/assets\\Script\\Tool\\ScrollMsg.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AACA,oBAAoB;AACpB,kFAAkF;AAClF,yFAAyF;AACzF,mBAAmB;AACnB,4FAA4F;AAC5F,mGAAmG;AACnG,8BAA8B;AAC9B,4FAA4F;AAC5F,mGAAmG;AAEnG,KAAK;AACC,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAyB,CAAC;AAG1C;IAAuC,6BAAY;IADnD;QAAA,qEA4HC;QAzHsB,cAAQ,GAAY,IAAI,CAAC;QACxB,WAAK,GAAa,IAAI,CAAC;QAG3C,cAAQ,GAAiB,IAAI,CAAC;QAGtB,gBAAU,GAAS,IAAI,CAAC;QAChC;;WAEG;QACH,gBAAU,GAAiB,IAAI,KAAK,EAAU,CAAA;QAC9C,cAAQ,GAAW,IAAI,CAAA;;IA6G3B,CAAC;IA3GG,0BAAM,GAAN;QAAA,iBA6BC;QA3BG,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAC,CAAC,EAAC,CAAC,CAAC,CAAA;QAE9C,kCAAkC;QAClC,IAAI;QACJ,+BAA+B;QAC/B,IAAI;QAEJ,2CAA2C;QAC3C,8CAA8C;QAE9C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAA;QACrE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;QAE7C,IAAI,MAAM,GAAG,MAAM,CAAC,aAAa,CAAC,CAAA;QAClC,IAAI,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,EAAC,OAAO,EAAE,MAAM,CAAC,CAAA;QAErD,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,GAAG,CAAC;QAC7B,yBAAyB;QACzB,gCAAgC;QAChC,IAAI,KAAK,GAAG,CAAC,CAAA;QACb,6BAA6B;QAC7B,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAC;YAErC,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAA;YACrB,KAAK,IAAI,CAAC,CAAA;YACV,GAAG,GAAG,GAAG,GAAI,KAAK,CAAA;QACtB,CAAC,CAAC,CAAA;IACN,CAAC;IAED,yBAAK,GAAL;IAEA,CAAC;IAED,iBAAiB;IAGjB;;;OAGG;IACH,+BAAW,GAAX,UAAY,OAAc;QAEtB,IAAI,IAAI,GAAG,IAAI,CAAA;QACf,IAAG,OAAO,IAAI,IAAI,IAAI,OAAO,CAAC,MAAM,IAAI,CAAC,EACzC;YACI,OAAM;SACT;QACD,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;QACvB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;QAC7B,IAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,IAAI;eAC1C,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,IAAI,KAAK,EAAC,aAAa;SAC7E;YACI,OAAM;SACT;QAED,IAAI,UAAU,GAAG;YAEb,IAAG,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAC7B;gBACI,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAA;gBAChD,4CAA4C;gBAC5C,0CAA0C;gBAC1C,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;gBAC7C,IAAI,QAAQ,GAAY,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAA;gBACtF,IAAI,QAAQ,GAAY,QAAQ,GAAG,GAAG,CAAA;gBACtC,IAAI,GAAG,GAAG,EAAE,CAAC,QAAQ,CACjB,EAAE,CAAC,MAAM,CAAC,QAAQ,EAAC,EAAE,CAAC,EAAE,CAAC,CAAC,QAAQ,EAAC,CAAC,CAAC,CAAC,EACtC,EAAE,CAAC,QAAQ,CAAC;oBACR,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAA;oBAC3B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;oBAC7C,UAAU,EAAE,CAAA;gBAChB,CAAC,CAAC,CACL,CAAA;gBACD,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAA;gBACb,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA;aACtC;iBAED;gBACI,2BAA2B;aAC9B;QACL,CAAC,CAAA;QACD,UAAU,EAAE,CAAA;IAChB,CAAC;IACD,6BAAS,GAAT;QAEI,IAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,IAAI,EACjD;YACK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAA;SAC3E;IACL,CAAC;IAED,+BAAW,GAAX,UAAY,QAAiB,EAAE,QAAiB,EAAE,IAAa;QAC3D,IAAI,GAAG,GAAY,EAAE,CAAC;QACtB,IAAI,MAAM,GAAY,CAAC,CAAA;QACvB,OAAO,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE;YACzB,IAAI,GAAG,GAAY,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;YACtC,GAAG,GAAG,GAAG,GAAG,cAAc,GAAG,GAAG,GAAG,KAAK,CAAA;YACxC,MAAM,EAAE,CAAC;SACZ;QACD,IAAI,WAAW,GAAY,yCAAyC,GAAC,GAAG,GAAC,QAAQ,GAAC,GAAG,GAAC,6BAA6B,CAAA;QACnH,IAAI,WAAW,GAAY,oBAAoB,GAAG,QAAQ,GAAG,8BAA8B,CAAA;QAC3F,IAAI,QAAQ,GAAW,sBAAsB,CAAA;QAC7C,OAAO,WAAW,GAAG,WAAW,GAAG,GAAG,GAAG,QAAQ,CAAA;IACrD,CAAC;IAvHkB;QAAlB,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;+CAA0B;IACxB;QAAnB,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;4CAAwB;IAG3C;QADC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC;+CACQ;IANb,SAAS;QAD7B,OAAO;OACa,SAAS,CA2H7B;IAAD,gBAAC;CA3HD,AA2HC,CA3HsC,EAAE,CAAC,SAAS,GA2HlD;kBA3HoB,SAAS","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Tool","sourcesContent":["import { G_Utils } from './Utils';\n// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\n//跑马灯\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class ScrollMsg extends cc.Component {\n\n    @property(cc.Node) maskNode: cc.Node = null;\n    @property(cc.Label) label: cc.Label = null;\n\n    @property(cc.RichText)\n    richText : cc.RichText = null;\n\n\n    private targetText : any = null;\n    /**\n     * 滾動內容\n     */\n    contentArr:Array<string> = new Array<string>()\n    startPos:cc.Vec2 = null\n\n    onLoad()\n    {\n        this.startPos = cc.v2(this.maskNode.width/2,0)\n\n        // if(this.contentArr.length == 0)\n        // {\n        //     this.node.active = false\n        // }\n\n        // this.label.node.position = this.startPos\n        // this.richText.node.position = this.startPos\n\n        this.targetText = this.label.node.active ? this.label : this.richText\n        this.targetText.node.position = this.startPos\n\n        var strNum = String(\"123456789.0\")\n        var str = this.getRichText(\"玩家昵称七个字\",\"石头剪刀布\", strNum)\n        \n        this.targetText.string = str;\n        // cc.find(\"Canvas/Btn\").\n        // let str = \"各位看官，大家好！\"+\"000??\"\n        let count = 0\n        // cc.Node.EventType.MOUSE_UP\n        this.node.on(cc.Node.EventType.TOUCH_END,()=>{\n            \n            this.startScroll(str)\n            count += 1\n            str = str  + count\n        })\n    }\n\n    start () {\n\n    }\n\n    // update (dt) {}\n\n\n    /**\n     * 開始滾動信息\n     * @param content 滾動內容\n     */\n    startScroll(content:string):void\n    {\n        let self = this\n        if(content == null || content.length == 0)\n        {\n            return\n        }\n        this.node.active = true\n        this.contentArr.push(content)\n        if(self.targetText.node.getActionByTag(0) != null \n            && this.targetText.node.getActionByTag(0).isDone() == false)//如果正在播放只插入數據\n        {\n            return\n        }\n\n        let scrollFunc = function()\n        {\n            if(self.contentArr.length > 0)\n            {\n                self.targetText.string = self.contentArr.shift()\n                //需要先更新標籤的寬度，不然下一幀才更新，這裏取到的值就會是原來的值，導致寬度計算錯誤\n                // self.targetText._updateRenderData(true)\n                self.targetText.node.position = self.startPos\n                let distance : number = self.targetText.node.width + self.targetText.node.parent.width\n                let duration : number = distance / 100\n                let seq = cc.sequence(\n                    cc.moveBy(duration,cc.v2(-distance,0)),\n                    cc.callFunc(function(){\n                        self.targetText.string = \"\"\n                        self.targetText.node.position = self.startPos\n                        scrollFunc()\n                    })\n                )\n                seq.setTag(0)\n                self.targetText.node.runAction(seq)\n            }\n            else\n            {\n                // self.node.active = false\n            }\n        }\n        scrollFunc()\n    }\n    onDestroy()\n    {\n        if(this.targetText.node.getActionByTag(0) != null )\n        {\n             this.targetText.node.stopAction(this.targetText.node.getActionByTag(0))\n        }\n    }\n\n    getRichText(userName : string, gameType : string, gold : string) : string {\n        var str : string = '';\n        var _count : number = 0\n        while (_count < gold.length) {\n            var num : string = gold.charAt(_count)\n            str = str + '<img src = \"' + num + '\"/>'\n            _count++;\n        }\n        var strUserName : string = '<color=#fee39b> 恭喜玩家 <color = #ffffff> '+'\"'+userName+'\"'+' </color><color=#fee39b> 在 '\n        var strGameType : string = '<color = #47fdcc> ' + gameType + ' </color><color = #fee39b> 中'\n        var goldText : string ='<color = #fee39b>金币。'\n        return strUserName + strGameType + str + goldText\n    }\n\n}\n"]}